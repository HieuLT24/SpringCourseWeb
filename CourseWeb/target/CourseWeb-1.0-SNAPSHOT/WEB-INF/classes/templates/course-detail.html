<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">
<head>
    <th:object th:replace="base :: head"></th:object>
    <!-- Course detail specific styles -->
    <style>
        .course-hero {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            padding: 4rem 0;
            margin-bottom: 2rem;
        }
        
        .course-info {
            background: white;
            border-radius: var(--border-radius);
            padding: 2rem;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
        }
        
        .price-tag {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            padding: 1rem 2rem;
            border-radius: var(--border-radius-lg);
            font-size: 1.5rem;
            font-weight: bold;
            display: inline-block;
            margin: 1rem 0;
            box-shadow: 0 5px 15px rgba(238, 90, 36, 0.4);
        }
        
        .enroll-btn {
            background: linear-gradient(45deg, #2ed573, #1e90ff);
            border: none;
            padding: 1rem 3rem;
            font-size: 1.2rem;
            font-weight: bold;
            border-radius: var(--border-radius-lg);
            color: white;
            transition: var(--transition);
            box-shadow: 0 5px 15px rgba(46, 213, 115, 0.4);
        }
        
        .enroll-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(46, 213, 115, 0.6);
            color: white;
        }
        
        .course-title {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 1rem;
            color: var(--dark-color);
        }
        
        .course-description {
            font-size: 1.1rem;
            line-height: 1.8;
            color: #555;
            margin-bottom: 2rem;
        }
        
        .feature-list {
            list-style: none;
            padding: 0;
        }
        
        .feature-list li {
            padding: 0.5rem 0;
            border-bottom: 1px solid #eee;
        }
        
        .feature-list li:before {
            content: "‚úì";
            color: #2ed573;
            font-weight: bold;
            margin-right: 1rem;
        }
        
        .back-btn {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
        }
        
        .back-btn:hover {
            color: var(--secondary-color);
            text-decoration: none;
        }
    </style>
</head>
<body class="main-wrapper">
    <div th:replace="base :: navbar"></div>

    <!-- Hero Section -->
    <section class="course-hero">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <img th:src="${course.image}" alt="Course Image" class="course-image-detail">
                </div>
                <div class="col-md-6">
                    <h1 class="display-4 font-weight-bold mb-4" th:text="${course.title}">T√™n kh√≥a h·ªçc</h1>
                    <div class="price-tag" th:text="${course.price} + ' VNƒê'">Gi√° kh√≥a h·ªçc</div>
                    <div class="mt-4">
                        <!-- N√∫t ƒëƒÉng k√Ω cho user ƒë√£ ƒëƒÉng nh·∫≠p -->
                        <button class="btn enroll-btn" sec:authorize="isAuthenticated()" 
                                th:onclick="'enrollCourse(' + ${course.id} + ')'">
                            üéì ƒêƒÉng k√Ω kh√≥a h·ªçc ngay
                        </button>
                        <!-- N√∫t ƒëƒÉng nh·∫≠p cho user ch∆∞a ƒëƒÉng nh·∫≠p -->
                        <a sec:authorize="!isAuthenticated()" 
                           th:href="@{/login}" class="btn enroll-btn">
                            üîê ƒêƒÉng nh·∫≠p ƒë·ªÉ ƒëƒÉng k√Ω
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Course Details -->
    <div class="content-wrapper">
        <div class="container">
        <div class="row">
            <div class="col-md-8">
                <div class="course-info">
                    <h2 class="course-title">V·ªÅ kh√≥a h·ªçc n√†y</h2>
                    <div class="course-description" th:text="${course.description}">
                        M√¥ t·∫£ kh√≥a h·ªçc s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y...
                    </div>
                    
                    <h3 class="mt-4 mb-3">B·∫°n s·∫Ω h·ªçc ƒë∆∞·ª£c g√¨?</h3>
                    <ul class="feature-list">
                        <li>Ki·∫øn th·ª©c n·ªÅn t·∫£ng v·ªØng ch·∫Øc</li>
                        <li>Th·ª±c h√†nh v·ªõi c√°c d·ª± √°n th·ª±c t·∫ø</li>
                        <li>H∆∞·ªõng d·∫´n t·ª´ gi·∫£ng vi√™n gi√†u kinh nghi·ªám</li>
                        <li>Ch·ª©ng ch·ªâ ho√†n th√†nh kh√≥a h·ªçc</li>
                        <li>H·ªó tr·ª£ h·ªçc t·∫≠p 24/7</li>
                    </ul>
                </div>
            </div>
            
            <div class="col-md-4">
                <div class="course-info">
                    <h3>Th√¥ng tin kh√≥a h·ªçc</h3>
                    <ul class="feature-list">
                        <li><strong>Gi·∫£ng vi√™n:</strong> <span th:text="${course.teacherId.name}">T√™n gi·∫£ng vi√™n</span></li>
                        <li><strong>Danh m·ª•c:</strong> <span th:text="${course.categoryId.name}">Danh m·ª•c</span></li>
                        <li><strong>Tr·∫°ng th√°i:</strong> <span th:text="${course.status}">Tr·∫°ng th√°i</span></li>
                        <li><strong>Gi√°:</strong> <span th:text="${course.price} + ' VNƒê'">Gi√°</span></li>
                    </ul>
                    
                    <div class="mt-4 text-center">
                        <!-- N√∫t ƒëƒÉng k√Ω l·ªõn -->
                        <button class="btn enroll-btn w-100" sec:authorize="isAuthenticated()" 
                                th:onclick="'enrollCourse(' + ${course.id} + ')'">
                            üéì ƒêƒÉng k√Ω ngay
                        </button>
                        <a sec:authorize="!isAuthenticated()" 
                           th:href="@{/login}" class="btn enroll-btn w-100">
                            üîê ƒêƒÉng nh·∫≠p ƒë·ªÉ ƒëƒÉng k√Ω
                        </a>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Back to home -->
        <div class="row mt-4">
            <div class="col-12">
                <a th:href="@{/}" class="back-btn">
                    ‚Üê Quay l·∫°i trang ch·ªß
                </a>
            </div>
        </div>
        </div>
    </div>

    <div th:replace="base :: footer"></div>
    
    <script th:inline="javascript">
        function enrollCourse(courseId) {
            if (confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ƒëƒÉng k√Ω kh√≥a h·ªçc n√†y?")) {
                var enrollUrl = /*[[@{/api/enroll/}]]*/ '/api/enroll/' + courseId;
                fetch(enrollUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    }
                }).then(response => {
                    if (response.ok) {
                        alert("ƒêƒÉng k√Ω kh√≥a h·ªçc th√†nh c√¥ng!");
                        // C√≥ th·ªÉ redirect ƒë·∫øn trang thanh to√°n ho·∫∑c trang kh√≥a h·ªçc c·ªßa t√¥i
                    } else {
                        alert("C√≥ l·ªói x·∫£y ra. Vui l√≤ng th·ª≠ l·∫°i!");
                    }
                }).catch(error => {
                    alert("C√≥ l·ªói x·∫£y ra. Vui l√≤ng th·ª≠ l·∫°i!");
                });
            }
        }
    </script>
</body>
</html>